<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediBot - Medical Information Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">

        <!-- Top Section: Medical Image + Disclaimer -->
        <div class="header-section">
            <img src="https://images.unsplash.com/photo-1576091160550-2173dba999ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80" 
                 alt="Medical professional" class="header-image">
            <div class="disclaimer-overlay">
                <h1>MediBot</h1>
                <p class="disclaimer-text">
                    <strong>Important:</strong> This AI assistant provides <strong>general medical information only</strong>.<br>
                    It is <strong>not a substitute</strong> for professional medical advice, diagnosis, or treatment.<br>
                    Always consult a qualified doctor or healthcare provider for personal health concerns.<br>
                    <span class="emergency">In emergencies, call your local emergency services immediately.</span>
                </p>
                <button id="accept-btn">I Understand â€“ Continue</button>
            </div>
        </div>

        <!-- Chat Area (centered) -->
        <div class="chat-box" id="chat-box" style="display: none;">
            <div class="messages" id="messages">
                <!-- Welcome message will appear after clicking "I Understand" -->
            </div>

            <div class="input-area">
                <input type="text" id="user-input" placeholder="Ask a general medical question..." disabled autocomplete="off">
                <button id="send-btn" disabled>
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>

    </div>

    <script>
        const acceptBtn = document.getElementById('accept-btn');
        const chatBox = document.getElementById('chat-box');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const messages = document.getElementById('messages');

        acceptBtn.addEventListener('click', () => {
            document.querySelector('.header-section').style.display = 'none';
            chatBox.style.display = 'flex';

            // Add welcome message
            addMessage('bot', `
                <p>Hello! I'm MediBot, here to help with <strong>general</strong> questions about health, symptoms, conditions, medications, and wellness.</p>
                <p>Please remember: I cannot diagnose illnesses or prescribe treatments.</p>
                <p>How can I assist you today?</p>
            `);

            userInput.disabled = false;
            sendBtn.disabled = false;
            userInput.focus();
        });

        function addMessage(sender, htmlContent) {
            const msgDiv = document.createElement('div');
            msgDiv.className = `message ${sender}-message`;
            msgDiv.innerHTML = `<div class="bubble">${htmlContent}</div>`;
            messages.appendChild(msgDiv);
            messages.scrollTop = messages.scrollHeight;
        }

        // Optional: Press Enter to send
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && userInput.value.trim()) {
                sendMessage();
            }
        });

        sendBtn.addEventListener('click', sendMessage);

        function sendMessage() {
            const text = userInput.value.trim();
            if (!text) return;

            // Add user message to chat
            addMessage('user', text);
            userInput.value = '';

            // Send to Flask backend
            fetch('/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ message: text })
            })
            .then(response => response.json())
            .then(data => {
                // Add bot response
                addMessage('bot', data.response);
            })
            .catch(error => {
                console.error('Error:', error);
                addMessage('bot', 'Sorry, something went wrong. Please try again.');
            });
        }
    </script>
</body>
</html>